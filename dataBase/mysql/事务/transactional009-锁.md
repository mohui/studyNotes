# 锁
## 读锁，写锁
> 从数据操作的类型划分： 读锁，写锁

> 对于数据库中并发事务`读-读`情况并不会引起什么问题，
> 对于`写-写`，`读-写`，`写-读`这些情况可能会引起一些问题
> 需要使用`MVCC`或者`加锁`的方式来解决它们，
> 在使用`加锁`的方式解决问题时，由于既要允许`读-读`情况不受影响，
> 又要使`写-写`，`读-写`，`写-读`情况中的操作`互相阻塞`，
> 所以mysql实现一个由两种类型的锁组成的锁系统来解决。
> 这两种类型的锁通常被称为`共享锁（Shared Lock, SLock）`和`排他锁（Exclusie Lock, XLock）`,
> 也叫`读锁（read lock）`和`写锁（write lock）`

- 读锁（S锁）
> `读锁`: 也称为`共享锁`，英文用`S`表示，
> 针对同一份数据，多个事务的读操作，可以同时进行而不会互相影响，相互不阻塞的
- 写锁（X锁）
> `写锁`： 也称为`排它锁`，英文用`X`表示。
> 当前些操作没有完成前，它会钻其他写锁和读锁，
> 这样就能确保在给定的时间里，只有一个事务能执行写入
> 并防止其他用户读取正在写入的同一资源 

- >需要注意的是，对于`innoDB`引擎来说，读锁和写锁可以加在表上，也可以加在行上

- 举例（行级读写锁）
> 如果一个事务T1已经获得了某个`行r`的读锁，那么此时另外一个事务T2是可以去获得这个`行r`的读锁的，
> 因为读取操作并没有改变`行r`的数据，但是，如果某个事务T3想获得`行r`的写锁，
> 则必须等待事务T1,T2,释放掉`行r`上的读锁才行

- 总结：这里的兼容是指对同一张表或记录的锁的兼容性情况

| 隔离级别 | X锁  | S锁  |
|------|-----|-----|
| X锁   | 不兼容 | 不兼容 |
| S锁   | 不兼容 | 兼容  |
